<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//w3c//dtd xhtml 1.0 strict//en" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<title>
			Knobz
		</title>
		<script src="pureknob.js" type="text/javascript"></script>
		<script type="text/javascript">
			// <![CDATA[

			/*
			 * Demo code for knob element.
			 */
			function demoKnob() {
				// Create knob element, 300 x 300 px in size.
				const knob = pureknob.createKnob(150, 150);

				// Set properties.
				knob.setProperty('angleStart', -0.5 * Math.PI);
				knob.setProperty('angleEnd', 0.5 * Math.PI);
				knob.setProperty('colorFG', '#11ff11');
				knob.setProperty('trackWidth', 0.1);
				knob.setProperty('valMin', 0);
				knob.setProperty('valMax', 22050);

				// Set initial value.
				knob.setValue(11025);

				/*
				 * Event listener.
				 *
				 * Parameter 'knob' is the knob object which was
				 * actuated. Allows you to associate data with
				 * it to discern which of your knobs was actuated.
				 *
				 * Parameter 'value' is the value which was set
				 * by the user.
				 */
				const listener = function(knob, value) {
					console.log(value);
				};

				knob.addListener(listener);

				// Create element node.
				const node = knob.node();

				// Add it to the DOM.
				const elem = document.getElementById('some_element');
				elem.appendChild(node);
			}

			/*
			 * Demo code for bar graph element.
			 */
			function demoBarGraph() {
				const body = document.getElementsByTagName('body')[0];
				const graph = pureknob.createBarGraph(150, 40);
				graph.setProperty('colorFG', '#00ff00');
				graph.setProperty('colorMarkers', '#0f0');
				graph.setProperty('markerStart', 19845);
				graph.setProperty('markerEnd', 19845);
				graph.setProperty('markerStep', 2205);
				graph.setProperty('valMin', 0);
				graph.setProperty('valMax', 22050);
				graph.setValue(11050);
				graph.setPeaks([10]);
				const node = graph.node();
				body.appendChild(node);
				window.graph = graph;

				/*
				 * This is executed on each timer tick.
				 */
				const t = function(e) {
					let v = graph.getValue();

					/*
					 * As long as value is greater than -80, decrement it.
					 */
					if (v > 0) {
						v--;
						graph.setValue(v);
					}

				};

				window.setInterval(t, 1);
			}

			/*
			 * This is executed after the document finished loading.
			 */
			function ready() {
				demoKnob();
				demoBarGraph();
			}

			document.addEventListener('DOMContentLoaded', ready, false);
			// ]]>
		</script>
	</head>
	<body style="background-color: #444444">
		<div id="some_element"/>
	</body>
</html>
